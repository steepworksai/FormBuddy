import{A as S,O as j,r as a,j as n,c as w}from"./client-ZUIU9geU.js";async function C(t){try{return t.provider==="anthropic"?await new S({apiKey:t.apiKey,dangerouslyAllowBrowser:!0}).messages.create({model:t.model,max_tokens:5,messages:[{role:"user",content:"hi"}]}):await new j({apiKey:t.apiKey,dangerouslyAllowBrowser:!0}).chat.completions.create({model:t.model,max_tokens:5,messages:[{role:"user",content:"hi"}]}),!0}catch(r){if(r instanceof Error){const s=r.message.toLowerCase();if(s.includes("401")||s.includes("403")||s.includes("invalid")||s.includes("authentication")||s.includes("api key")||s.includes("not found"))return!1}throw r}}const u=[{value:"anthropic",label:"Anthropic Claude",models:["claude-sonnet-4-6","claude-opus-4-6","claude-haiku-4-5-20251001"],url:"https://console.anthropic.com"},{value:"openai",label:"OpenAI",models:["gpt-4o","gpt-4o-mini"],url:"https://platform.openai.com"}];async function z(){return new Promise(t=>{chrome.storage.local.get("llmConfig",r=>t(r.llmConfig??null))})}async function A(t){return new Promise(r=>chrome.storage.local.set({llmConfig:t},r))}async function P(){return new Promise(t=>chrome.storage.local.remove("llmConfig",t))}function B(){const[t,r]=a.useState("anthropic"),[s,x]=a.useState(u[0].models[0]),[f,g]=a.useState(""),[i,l]=a.useState("idle"),[h,c]=a.useState("");a.useEffect(()=>{z().then(e=>{e&&(r(e.provider),x(e.model),g(e.apiKey),l("connected"))})},[]);const y=u.find(e=>e.value===t);function m(e){r(e),x(u.find(p=>p.value===e).models[0]),i==="connected"&&l("idle")}async function b(){const e=f.trim();if(!e){l("invalid"),c("API key is required.");return}l("verifying"),c("");const p={provider:t,model:s,apiKey:e};try{if(!await C(p)){l("invalid"),c("Invalid key — check it and try again.");return}await A(p),l("connected")}catch{l("error"),c("Network error — check your connection and try again.")}}async function v(){await P(),g(""),l("idle"),c("")}const d=i==="verifying",k=i==="verifying"?"Verifying…":i==="connected"?"✓ Connected":"Verify & Save";return n.jsxs("div",{style:o.container,children:[n.jsxs("div",{style:o.header,children:[n.jsx("span",{style:o.logo,children:"FormBuddy Settings"}),i==="connected"&&n.jsx("span",{style:o.connectedBadge,children:"● Connected"})]}),n.jsx("label",{style:o.label,children:"Provider"}),n.jsx("select",{style:o.select,value:t,onChange:e=>m(e.target.value),disabled:d,children:u.map(e=>n.jsx("option",{value:e.value,children:e.label},e.value))}),n.jsxs("button",{style:o.linkButton,onClick:()=>chrome.tabs.create({url:y.url}),children:["Get API key from ",y.label," ↗"]}),n.jsx("label",{style:o.label,children:"Model"}),n.jsx("select",{style:o.select,value:s,onChange:e=>{x(e.target.value),i==="connected"&&l("idle")},disabled:d,children:y.models.map(e=>n.jsx("option",{value:e,children:e},e))}),n.jsx("label",{style:o.label,children:"API Key"}),n.jsx("input",{style:{...o.input,borderColor:i==="invalid"?"#d93025":"#ccc"},type:"password",placeholder:"Paste your API key here",value:f,onChange:e=>{g(e.target.value),i!=="idle"&&l("idle")},disabled:d}),n.jsxs("div",{style:o.row,children:[n.jsx("button",{style:{...o.button,opacity:d?.7:1,background:i==="connected"?"#059669":"#1a73e8"},onClick:b,disabled:d||i==="connected",children:k}),i==="connected"&&n.jsx("button",{style:o.disconnectButton,onClick:v,children:"Disconnect"})]}),i==="invalid"&&n.jsxs("p",{style:o.invalidMsg,children:["✗ ",h]}),i==="error"&&n.jsxs("p",{style:o.errorMsg,children:["⚠ ",h]}),i==="verifying"&&n.jsx("p",{style:o.infoMsg,children:"Making a test call to verify your key…"})]})}const o={container:{width:"300px",padding:"16px",fontFamily:"system-ui, sans-serif",fontSize:"13px",color:"#111"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"14px"},logo:{fontSize:"14px",fontWeight:700},connectedBadge:{background:"#d1fae5",color:"#065f46",fontSize:"11px",padding:"2px 8px",borderRadius:"999px",fontWeight:600},label:{display:"block",fontWeight:600,fontSize:"12px",marginBottom:"4px",marginTop:"12px",color:"#374151"},select:{width:"100%",padding:"6px 8px",borderRadius:"5px",border:"1px solid #ccc",fontSize:"13px",boxSizing:"border-box"},input:{width:"100%",padding:"6px 8px",borderRadius:"5px",border:"1px solid #ccc",fontSize:"13px",boxSizing:"border-box",outline:"none"},linkButton:{background:"none",border:"none",color:"#1a73e8",cursor:"pointer",fontSize:"11px",padding:"3px 0 0",display:"block"},row:{display:"flex",gap:"8px",marginTop:"14px"},button:{flex:1,padding:"8px",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",fontWeight:600,fontSize:"13px",transition:"background 0.2s"},disconnectButton:{padding:"8px 12px",background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"5px",cursor:"pointer",fontSize:"13px"},invalidMsg:{color:"#d93025",fontSize:"12px",marginTop:"8px",margin:"8px 0 0"},errorMsg:{color:"#b45309",fontSize:"12px",marginTop:"8px",margin:"8px 0 0"},infoMsg:{color:"#6b7280",fontSize:"11px",marginTop:"8px",margin:"8px 0 0"}};w.createRoot(document.getElementById("root")).render(n.jsx(a.StrictMode,{children:n.jsx(B,{})}));
